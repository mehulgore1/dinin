{"ast":null,"code":"var _jsxFileName = \"/Users/mehulgore/projects/dinin/client/src/eater/BasketItem.js\";\nimport React, { useState, useEffect, Fragment, useReducer } from \"react\";\nimport \"../App.css\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport * as firebase from \"firebase\";\n\nconst BasketItem = props => {\n  const [modalShow, setModalShow] = useState(false);\n  const {\n    item,\n    tableData,\n    batch_key,\n    seat,\n    itemRef,\n    deleteItem,\n    item_key,\n    userId,\n    params\n  } = props;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(BasketItemDetailsModal, {\n    item: item,\n    item_key: item_key,\n    batch_key: batch_key,\n    seat: seat,\n    show: modalShow,\n    onHide: () => setModalShow(false),\n    itemRef: itemRef,\n    setModalShow: setModalShow,\n    deleteItem: deleteItem,\n    userId: userId,\n    params: params,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row align-items-center h-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-dark\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 15\n    }\n  }, props.item[\"quantity\"]))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 13\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 15\n    }\n  }, item[\"title\"])), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }\n  }, item[\"notes\"]), tableData[\"batches\"][batch_key] != \"\" && \"ordered_at\" in tableData[\"batches\"][batch_key] ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 19\n    }\n  }, \"Status \"), item[\"status\"] == \"Kitchen Preparing\" ? /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-pill badge-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 21\n    }\n  }, item[\"status\"]) : /*#__PURE__*/React.createElement(\"span\", {\n    className: \"badge badge-pill badge-warning\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 21\n    }\n  }, item[\"status\"]))) : null), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 11\n    }\n  }, props.userInThisSeat(seat) && !item[\"ordered\"] ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-around\",\n    onClick: e => e.stopPropagation(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-warning mr-3\",\n    onClick: () => setModalShow(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, \"Edit\")) : null))), /*#__PURE__*/React.createElement(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default BasketItem;\n\nfunction BasketItemDetailsModal(props) {\n  const {\n    batch_key,\n    item_key,\n    seat,\n    item,\n    itemRef,\n    userId,\n    params\n  } = props;\n  const [quantity, setQuantity] = useState(item[\"quantity\"]);\n  const [notes, setNotes] = useState(item[\"notes\"]);\n  const [splitSeats, setSplitSeats] = useState({});\n  const [isSplit, setIsSplit] = useState(false);\n  const [serverSplit, setServerSplit] = useState(false);\n  const [ignored, forceUpdate] = useReducer(x => x + 1, 0);\n  const database = firebase.database();\n  const seatDataRef = database.ref(params.restaurant).child(\"tables\").child(params.table).child(\"batches\").child(batch_key).child(\"seat_data\");\n  useEffect(() => {\n    itemRef.on(\"value\", function (snapshot) {\n      var split = snapshot.hasChild(\"split\");\n\n      if (split) {\n        // already split set quantity to 1\n        setQuantity(1);\n      }\n\n      setIsSplit(split);\n      setServerSplit(split);\n\n      if (split) {\n        // get split seats\n        itemRef.child(\"split\").once(\"value\").then(function (snapshot) {\n          var tempSplitSeats = {};\n          var splits = snapshot.val();\n          var arrayLength = splits.length;\n\n          for (var i = 0; i < arrayLength; i++) {\n            if (splits[i]) {\n              tempSplitSeats[i] = splits[i];\n            }\n          }\n\n          setSplitSeats(tempSplitSeats);\n        });\n      } else {\n        // create split seats\n        database.ref(params.restaurant).child(\"tables\").child(params.table).child(\"users\").once(\"value\").then(function (snapshot) {\n          var users = snapshot.val();\n          var tempSplitSeats = {};\n\n          for (var id in users) {\n            var name = users[id][\"name\"];\n            var seat = users[id][\"seat\"];\n            tempSplitSeats[seat] = {};\n            tempSplitSeats[seat][\"taken\"] = false;\n            tempSplitSeats[seat][\"name\"] = name;\n            tempSplitSeats[seat][\"user_id\"] = id;\n          }\n\n          console.log(tempSplitSeats);\n          setSplitSeats(tempSplitSeats);\n        });\n      }\n    });\n  }, []);\n\n  const incQuantity = () => {\n    if (quantity < 1) {\n      setQuantity(1);\n    } else {\n      setQuantity(quantity + 1);\n    }\n  };\n\n  const decQuantity = () => {\n    var newQuantity = quantity - 1;\n\n    if (newQuantity < 1) {\n      newQuantity = 1;\n    }\n\n    setQuantity(newQuantity);\n  };\n\n  const updateItem = () => {\n    var tempSplitSeats = splitSeats;\n    var validSplit = false;\n\n    for (var seat in splitSeats) {\n      if (splitSeats[seat][\"taken\"] && splitSeats[seat][\"user_id\"] != userId) {\n        // other seat selected, split is valid\n        validSplit = true;\n      }\n    }\n\n    validSplit = validSplit && isSplit;\n\n    if (validSplit) {\n      // already split once, just adjusting now\n      for (var seat in splitSeats) {\n        if (validSplit && splitSeats[seat][\"user_id\"] == props.userId) {\n          // valid split, need to add current user\n          tempSplitSeats[seat][\"taken\"] = true;\n        }\n      }\n\n      var splitCount = 0;\n\n      for (var seat in tempSplitSeats) {\n        // find number of splitting people\n        if (tempSplitSeats[seat][\"taken\"]) {\n          splitCount++;\n        }\n      }\n\n      var fraction = Number((quantity / splitCount).toFixed(2));\n      var tempItem = {\n        title: item[\"title\"],\n        notes: notes,\n        category: item[\"category\"],\n        quantity: fraction,\n        status: \"Order Sent\",\n        ordered: false,\n        price: item[\"price\"]\n      };\n      tempItem.split = tempSplitSeats;\n\n      for (var currSeat in tempSplitSeats) {\n        // if taken, then update, otherwise remove\n        if (tempSplitSeats[currSeat][\"taken\"]) {\n          seatDataRef.child(currSeat).child(\"items\").child(item_key).update(tempItem);\n        } else {\n          seatDataRef.child(currSeat).child(\"items\").child(item_key).remove();\n        }\n      }\n    } else if (!validSplit && serverSplit) {\n      // removing split from this item, delete from other users besides yourself\n      for (var currSeat in splitSeats) {\n        if (splitSeats[currSeat][\"user_id\"] != userId) {\n          seatDataRef.child(currSeat).child(\"items\").child(item_key).remove();\n        } else {\n          // your userId, remove \"split\" and reset quantity\n          itemRef.child(\"split\").remove();\n          itemRef.update({\n            quantity: quantity\n          });\n        }\n      }\n    } else {\n      // no split, just update\n      itemRef.child(\"quantity\").set(quantity);\n      itemRef.child(\"notes\").set(notes);\n    }\n  };\n\n  const toggleSplitSeat = seat => {\n    var tempSplitSeats = splitSeats;\n    tempSplitSeats[seat][\"taken\"] = !tempSplitSeats[seat][\"taken\"];\n    setSplitSeats(tempSplitSeats);\n    forceUpdate();\n  };\n\n  const toggleSplit = () => {\n    if (!isSplit) {\n      // going to be split, need to reset quantity to 1\n      setQuantity(1);\n    }\n\n    setIsSplit(isSplit => !isSplit);\n  };\n\n  const deleteItem = (batch_key, seat, item_key) => {\n    if (isSplit) {\n      // need to remove from all other seats\n      for (var currSeat in splitSeats) {\n        if (splitSeats[currSeat][\"user_id\"] != userId) {\n          database.ref(params.restaurant).child(\"tables\").child(params.table).child(\"batches\").child(batch_key).child(\"seat_data\").child(currSeat).child(\"items\").child(item_key).remove();\n        }\n      }\n    }\n\n    props.setModalShow(false); // remove logic for current session seat\n\n    props.deleteItem(batch_key, seat, item_key);\n  };\n\n  return /*#__PURE__*/React.createElement(Modal, Object.assign({}, props, {\n    size: \"lg\",\n    \"aria-labelledby\": \"contained-modal-title-vcenter\",\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    id: \"contained-modal-title-vcenter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 9\n    }\n  }, item[\"title\"], \"  \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => deleteItem(batch_key, seat, item_key),\n    className: \"btn btn-danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 11\n    }\n  }, \"Delete\"))), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mt-2\",\n    type: \"text\",\n    value: notes,\n    placeholder: \"Add Notes, Customize...\",\n    onChange: e => setNotes(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => decQuantity(),\n    className: \"btn btn-outline-dark mr-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 11\n    }\n  }, \" \", \"-\", \" \"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"align-self-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 11\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 13\n    }\n  }, \" \", quantity, \" \")), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => incQuantity(),\n    className: \"btn btn-outline-dark ml-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 11\n    }\n  }, \" \", \"+\", \" \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-3 mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: toggleSplit,\n    className: \"btn btn-warning btn-lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 11\n    }\n  }, isSplit ? \"Remove Split\" : \"Split\")), isSplit ? /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"list-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 11\n    }\n  }, \" \", Object.keys(splitSeats).map(seat => {\n    var active = splitSeats[seat][\"taken\"] ? \"active\" : \"\";\n\n    if (splitSeats[seat][\"user_id\"] == props.userId) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: seat,\n      className: \"list-group-item \" + active,\n      onClick: () => toggleSplitSeat(seat),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 17\n      }\n    }, \" \", splitSeats[seat][\"name\"], \" \");\n  })) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-around mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-lg btn-dark btn-block mt-3\",\n    onClick: () => {\n      props.setModalShow(false);\n      updateItem();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 11\n    }\n  }, \"Save\"))));\n}","map":{"version":3,"sources":["/Users/mehulgore/projects/dinin/client/src/eater/BasketItem.js"],"names":["React","useState","useEffect","Fragment","useReducer","Modal","Button","firebase","BasketItem","props","modalShow","setModalShow","item","tableData","batch_key","seat","itemRef","deleteItem","item_key","userId","params","userInThisSeat","e","stopPropagation","BasketItemDetailsModal","quantity","setQuantity","notes","setNotes","splitSeats","setSplitSeats","isSplit","setIsSplit","serverSplit","setServerSplit","ignored","forceUpdate","x","database","seatDataRef","ref","restaurant","child","table","on","snapshot","split","hasChild","once","then","tempSplitSeats","splits","val","arrayLength","length","i","users","id","name","console","log","incQuantity","decQuantity","newQuantity","updateItem","validSplit","splitCount","fraction","Number","toFixed","tempItem","title","category","status","ordered","price","currSeat","update","remove","set","toggleSplitSeat","toggleSplit","target","value","Object","keys","map","active"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment, useReducer } from \"react\";\nimport \"../App.css\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport * as firebase from \"firebase\";\n\nconst BasketItem = props => {\n  const [modalShow, setModalShow] = useState(false);\n  const {\n    item,\n    tableData,\n    batch_key,\n    seat,\n    itemRef,\n    deleteItem,\n    item_key,\n    userId,\n    params\n  } = props;\n\n  return (\n    <div>\n      <BasketItemDetailsModal\n        item={item}\n        item_key={item_key}\n        batch_key={batch_key}\n        seat={seat}\n        show={modalShow}\n        onHide={() => setModalShow(false)}\n        itemRef={itemRef}\n        setModalShow={setModalShow}\n        deleteItem={deleteItem}\n        userId={userId}\n        params={params}\n      />\n      <div className=\"container\">\n        <div className=\"row align-items-center h-100\">\n          <div className=\"col\">\n            <h3>\n              <span className=\"badge badge-dark\">{props.item[\"quantity\"]}</span>\n            </h3>\n          </div>\n          <div className=\"col-6\">\n            <div>\n              {\" \"}\n              <strong>{item[\"title\"]}</strong>\n            </div>\n            <div>{item[\"notes\"]}</div>\n            {tableData[\"batches\"][batch_key] != \"\" &&\n            \"ordered_at\" in tableData[\"batches\"][batch_key] ? (\n              <div>\n                <h6>\n                  <strong>Status </strong>\n                  {item[\"status\"] == \"Kitchen Preparing\" ? (\n                    <span className=\"badge badge-pill badge-success\">\n                      {item[\"status\"]}\n                    </span>\n                  ) : (\n                    <span className=\"badge badge-pill badge-warning\">\n                      {item[\"status\"]}\n                    </span>\n                  )}\n                </h6>\n              </div>\n            ) : null}\n          </div>\n          <div className=\"col\">\n            {props.userInThisSeat(seat) && !item[\"ordered\"] ? (\n              <div\n                className=\"d-flex justify-content-around\"\n                onClick={e => e.stopPropagation()}\n              >\n                <button\n                  className=\"btn btn-warning mr-3\"\n                  onClick={() => setModalShow(true)}\n                >\n                  Edit\n                </button>\n              </div>\n            ) : null}\n          </div>\n        </div>\n      </div>\n      <hr />\n    </div>\n  );\n};\n\nexport default BasketItem;\n\nfunction BasketItemDetailsModal(props) {\n  const { batch_key, item_key, seat, item, itemRef, userId, params } = props;\n  const [quantity, setQuantity] = useState(item[\"quantity\"]);\n  const [notes, setNotes] = useState(item[\"notes\"]);\n  const [splitSeats, setSplitSeats] = useState({});\n  const [isSplit, setIsSplit] = useState(false);\n  const [serverSplit, setServerSplit] = useState(false);\n  const [ignored, forceUpdate] = useReducer(x => x + 1, 0);\n  const database = firebase.database();\n  const seatDataRef = database\n    .ref(params.restaurant)\n    .child(\"tables\")\n    .child(params.table)\n    .child(\"batches\")\n    .child(batch_key)\n    .child(\"seat_data\");\n\n  useEffect(() => {\n    itemRef.on(\"value\", function(snapshot) {\n      var split = snapshot.hasChild(\"split\");\n      if (split) {\n        // already split set quantity to 1\n        setQuantity(1);\n      }\n      setIsSplit(split);\n      setServerSplit(split);\n      if (split) {\n        // get split seats\n        itemRef\n          .child(\"split\")\n          .once(\"value\")\n          .then(function(snapshot) {\n            var tempSplitSeats = {};\n            var splits = snapshot.val();\n            var arrayLength = splits.length;\n            for (var i = 0; i < arrayLength; i++) {\n              if (splits[i]) {\n                tempSplitSeats[i] = splits[i];\n              }\n            }\n            setSplitSeats(tempSplitSeats);\n          });\n      } else {\n        // create split seats\n        database\n          .ref(params.restaurant)\n          .child(\"tables\")\n          .child(params.table)\n          .child(\"users\")\n          .once(\"value\")\n          .then(function(snapshot) {\n            var users = snapshot.val();\n            var tempSplitSeats = {};\n            for (var id in users) {\n              var name = users[id][\"name\"];\n              var seat = users[id][\"seat\"];\n              tempSplitSeats[seat] = {};\n              tempSplitSeats[seat][\"taken\"] = false;\n              tempSplitSeats[seat][\"name\"] = name;\n              tempSplitSeats[seat][\"user_id\"] = id;\n            }\n            console.log(tempSplitSeats);\n            setSplitSeats(tempSplitSeats);\n          });\n      }\n    });\n  }, []);\n\n  const incQuantity = () => {\n    if (quantity < 1) {\n      setQuantity(1);\n    } else {\n      setQuantity(quantity + 1);\n    }\n  };\n\n  const decQuantity = () => {\n    var newQuantity = quantity - 1;\n    if (newQuantity < 1) {\n      newQuantity = 1;\n    }\n    setQuantity(newQuantity);\n  };\n\n  const updateItem = () => {\n    var tempSplitSeats = splitSeats;\n    var validSplit = false;\n    for (var seat in splitSeats) {\n      if (splitSeats[seat][\"taken\"] && splitSeats[seat][\"user_id\"] != userId) {\n        // other seat selected, split is valid\n        validSplit = true;\n      }\n    }\n    validSplit = validSplit && isSplit;\n    if (validSplit) {\n      // already split once, just adjusting now\n      for (var seat in splitSeats) {\n        if (validSplit && splitSeats[seat][\"user_id\"] == props.userId) {\n          // valid split, need to add current user\n          tempSplitSeats[seat][\"taken\"] = true;\n        }\n      }\n      var splitCount = 0;\n      for (var seat in tempSplitSeats) {\n        // find number of splitting people\n        if (tempSplitSeats[seat][\"taken\"]) {\n          splitCount++;\n        }\n      }\n      var fraction = Number((quantity / splitCount).toFixed(2));\n      var tempItem = {\n        title: item[\"title\"],\n        notes: notes,\n        category: item[\"category\"],\n        quantity: fraction,\n        status: \"Order Sent\",\n        ordered: false,\n        price: item[\"price\"]\n      };\n      tempItem.split = tempSplitSeats;\n      for (var currSeat in tempSplitSeats) {\n        // if taken, then update, otherwise remove\n        if (tempSplitSeats[currSeat][\"taken\"]) {\n          seatDataRef\n            .child(currSeat)\n            .child(\"items\")\n            .child(item_key)\n            .update(tempItem);\n        } else {\n          seatDataRef\n            .child(currSeat)\n            .child(\"items\")\n            .child(item_key)\n            .remove();\n        }\n      }\n    } else if (!validSplit && serverSplit) {\n      // removing split from this item, delete from other users besides yourself\n      for (var currSeat in splitSeats) {\n        if (splitSeats[currSeat][\"user_id\"] != userId) {\n          seatDataRef\n            .child(currSeat)\n            .child(\"items\")\n            .child(item_key)\n            .remove();\n        } else {\n          // your userId, remove \"split\" and reset quantity\n          itemRef.child(\"split\").remove();\n          itemRef.update({ quantity: quantity });\n        }\n      }\n    } else {\n      // no split, just update\n      itemRef.child(\"quantity\").set(quantity);\n      itemRef.child(\"notes\").set(notes);\n    }\n  };\n\n  const toggleSplitSeat = seat => {\n    var tempSplitSeats = splitSeats;\n    tempSplitSeats[seat][\"taken\"] = !tempSplitSeats[seat][\"taken\"];\n    setSplitSeats(tempSplitSeats);\n    forceUpdate();\n  };\n\n  const toggleSplit = () => {\n    if (!isSplit) {\n      // going to be split, need to reset quantity to 1\n      setQuantity(1);\n    }\n    setIsSplit(isSplit => !isSplit);\n  };\n\n  const deleteItem = (batch_key, seat, item_key) => {\n    if (isSplit) {\n      // need to remove from all other seats\n      for (var currSeat in splitSeats) {\n        if (splitSeats[currSeat][\"user_id\"] != userId) {\n          database\n            .ref(params.restaurant)\n            .child(\"tables\")\n            .child(params.table)\n            .child(\"batches\")\n            .child(batch_key)\n            .child(\"seat_data\")\n            .child(currSeat)\n            .child(\"items\")\n            .child(item_key)\n            .remove();\n        }\n      }\n    }\n    props.setModalShow(false);\n    // remove logic for current session seat\n    props.deleteItem(batch_key, seat, item_key);\n  };\n\n  return (\n    <Modal\n      {...props}\n      size=\"lg\"\n      aria-labelledby=\"contained-modal-title-vcenter\"\n      centered\n    >\n      <Modal.Header>\n        <Modal.Title id=\"contained-modal-title-vcenter\">\n          {item[\"title\"]}\n          {\"  \"}\n          <button\n            onClick={() => deleteItem(batch_key, seat, item_key)}\n            className=\"btn btn-danger\"\n          >\n            Delete\n          </button>\n        </Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <div>\n          <input\n            className=\"form-control mt-2\"\n            type=\"text\"\n            value={notes}\n            placeholder=\"Add Notes, Customize...\"\n            onChange={e => setNotes(e.target.value)}\n          />\n        </div>\n        <div className=\"d-flex justify-content-center mt-3\">\n          <button\n            onClick={() => decQuantity()}\n            className=\"btn btn-outline-dark mr-3\"\n          >\n            {\" \"}\n            -{\" \"}\n          </button>\n          <div className=\"align-self-center\">\n            {\" \"}\n            <h3> {quantity} </h3>\n          </div>\n          <button\n            onClick={() => incQuantity()}\n            className=\"btn btn-outline-dark ml-3\"\n          >\n            {\" \"}\n            +{\" \"}\n          </button>\n        </div>\n        <div className=\"d-flex justify-content-center mt-3 mb-3\">\n          <button onClick={toggleSplit} className=\"btn btn-warning btn-lg\">\n            {isSplit ? \"Remove Split\" : \"Split\"}\n          </button>\n        </div>\n\n        {isSplit ? (\n          <ul className=\"list-group\">\n            {\" \"}\n            {Object.keys(splitSeats).map(seat => {\n              var active = splitSeats[seat][\"taken\"] ? \"active\" : \"\";\n              if (splitSeats[seat][\"user_id\"] == props.userId) {\n                return null;\n              }\n              return (\n                <li\n                  key={seat}\n                  className={\"list-group-item \" + active}\n                  onClick={() => toggleSplitSeat(seat)}\n                >\n                  {\" \"}\n                  {splitSeats[seat][\"name\"]}{\" \"}\n                </li>\n              );\n            })}\n          </ul>\n        ) : null}\n        <div className=\"d-flex justify-content-around mt-3\">\n          <button\n            className=\"btn btn-lg btn-dark btn-block mt-3\"\n            onClick={() => {\n              props.setModalShow(false);\n              updateItem();\n            }}\n          >\n            Save\n          </button>\n        </div>\n      </Modal.Body>\n    </Modal>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}