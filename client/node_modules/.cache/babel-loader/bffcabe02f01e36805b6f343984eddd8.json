{"ast":null,"code":"var _jsxFileName = \"/Users/mehulgore/projects/dinin/client/src/eater/LoginForm.js\";\nimport React, { useState, useEffect, Fragment } from \"react\";\nimport \"../App.css\";\nimport * as firebase from \"firebase\";\n\nconst LoginForm = props => {\n  const database = firebase.database();\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [authCode, setAuthCode] = useState(\"\");\n  const [confResult, setConfResult] = useState({});\n  const [name, setName] = useState(\"\");\n  const [anonName, setAnonName] = useState(\"\");\n  const [offersChecked, setOffersChecked] = useState(true);\n  const [guestSignIn, setGuestSignIn] = useState(false);\n\n  const sendVerificationCode = () => {\n    if (phoneNumber == \"\") {\n      window.alert(\"Number is Empty!\");\n      return;\n    }\n\n    var appVerifier = window.recaptchaVerifier;\n    firebase.auth().signInWithPhoneNumber(\"+1\" + phoneNumber, appVerifier).then(function (confirmationResult) {\n      // SMS sent. Prompt user to type the code from the message, then sign the\n      // user in with confirmationResult.confirm(code).\n      console.log(\"SMS sent\");\n      window.confirmationResult = confirmationResult;\n      setConfResult(confirmationResult);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const signInWithPhoneNumber = () => {\n    if (name == \"\") {\n      window.alert(\"Name is Empty!\");\n      return;\n    }\n\n    if (Object.keys(confResult).length !== 0) {\n      confResult.confirm(authCode).then(function (result) {\n        // User signed in successfully.\n        var user = result.user;\n        database.ref(\"users\").child(user.uid).update({\n          phone_number: user.phoneNumber\n        });\n        database.ref(\"users\").child(user.uid).child(\"restaurants\").child(props.match.params.restaurant).update({\n          offers: offersChecked\n        });\n        addUserToDb(user.uid, name);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  };\n\n  useEffect(() => {\n    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\"sign-in-button\", {\n      size: \"invisible\",\n      callback: function (response) {}\n    });\n  }, []);\n\n  const signInAsGuest = () => {\n    if (anonName != \"\") {\n      firebase.auth().signInAnonymously().then(result => {\n        addUserToDb(result.user.uid, anonName);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    } else {\n      window.alert(\"Name is Empty!\");\n    }\n  };\n\n  const addUserToDb = (uid, thisName) => {\n    database.ref(\"users\").child(uid).update({\n      name: thisName,\n      type: \"customer\"\n    });\n    database.ref(props.match.params.restaurant).child(\"tables\").child(props.match.params.table).child(\"users\").child(uid).update({\n      name: thisName,\n      seat: props.match.params.seat,\n      water_ordered: false\n    });\n  };\n\n  const showGuestSignIn = () => {\n    setGuestSignIn(true);\n  };\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    className: \"text-capitalize\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }\n  }, \" \", \"Welcome to \", props.match.params.restaurant)), props.seatTaken ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    style: {\n      color: \"red\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 11\n    }\n  }, \" Seat Taken! \"), \" \") : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, \" Verify Your Seat \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, \" You only have to do this once! \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mt-5\",\n    type: \"text\",\n    value: phoneNumber,\n    placeholder: \"Phone Number\",\n    onChange: e => setPhoneNumber(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-warning btn-lg btn-block\",\n    onClick: sendVerificationCode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 11\n    }\n  }, \" \", \"Send Code\", \" \")), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mt-5\",\n    type: \"text\",\n    value: authCode,\n    placeholder: \"6-Digit Verification Code\",\n    onChange: e => setAuthCode(e.target.value),\n    autoComplete: \"one-time-code\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control mt-2\",\n    type: \"text\",\n    value: name,\n    placeholder: \"Enter your Name\",\n    onChange: e => setName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-dark btn-lg btn-block\",\n    id: \"sign-in-button\",\n    onClick: signInWithPhoneNumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 11\n    }\n  }, \" \", \"Let's Go!\", \" \"))), guestSignIn ? /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"text-muted mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }\n  }, \" Sign In As Guest \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-muted\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }, \"Not Recommended - Your data will be lost\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"form-control\",\n    type: \"text\",\n    value: anonName,\n    placeholder: \"Enter your Name\",\n    onChange: e => setAnonName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    onClick: function () {},\n    className: \"d-flex justify-content-center mt-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-outline-secondary btn-sm btn-block\",\n    onClick: signInAsGuest,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 15\n    }\n  }, \"Guest Login\")))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-flex justify-content-center mt-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: showGuestSignIn,\n    className: \"btn btn-link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 11\n    }\n  }, \" \", \"Sign In a Different Way\", \" \")));\n};\n\nexport default LoginForm;","map":{"version":3,"sources":["/Users/mehulgore/projects/dinin/client/src/eater/LoginForm.js"],"names":["React","useState","useEffect","Fragment","firebase","LoginForm","props","database","phoneNumber","setPhoneNumber","authCode","setAuthCode","confResult","setConfResult","name","setName","anonName","setAnonName","offersChecked","setOffersChecked","guestSignIn","setGuestSignIn","sendVerificationCode","window","alert","appVerifier","recaptchaVerifier","auth","signInWithPhoneNumber","then","confirmationResult","console","log","catch","error","Object","keys","length","confirm","result","user","ref","child","uid","update","phone_number","match","params","restaurant","offers","addUserToDb","RecaptchaVerifier","size","callback","response","signInAsGuest","signInAnonymously","thisName","type","table","seat","water_ordered","showGuestSignIn","seatTaken","color","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from \"react\";\nimport \"../App.css\";\nimport * as firebase from \"firebase\";\n\nconst LoginForm = props => {\n  const database = firebase.database();\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n  const [authCode, setAuthCode] = useState(\"\");\n  const [confResult, setConfResult] = useState({});\n  const [name, setName] = useState(\"\");\n  const [anonName, setAnonName] = useState(\"\");\n  const [offersChecked, setOffersChecked] = useState(true);\n  const [guestSignIn, setGuestSignIn] = useState(false);\n\n  const sendVerificationCode = () => {\n    if (phoneNumber == \"\") {\n      window.alert(\"Number is Empty!\");\n      return;\n    }\n    var appVerifier = window.recaptchaVerifier;\n    firebase\n      .auth()\n      .signInWithPhoneNumber(\"+1\" + phoneNumber, appVerifier)\n      .then(function(confirmationResult) {\n        // SMS sent. Prompt user to type the code from the message, then sign the\n        // user in with confirmationResult.confirm(code).\n        console.log(\"SMS sent\");\n        window.confirmationResult = confirmationResult;\n        setConfResult(confirmationResult);\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n  };\n\n  const signInWithPhoneNumber = () => {\n    if (name == \"\") {\n      window.alert(\"Name is Empty!\");\n      return;\n    }\n    if (Object.keys(confResult).length !== 0) {\n      confResult\n        .confirm(authCode)\n        .then(function(result) {\n          // User signed in successfully.\n          var user = result.user;\n          database\n            .ref(\"users\")\n            .child(user.uid)\n            .update({\n              phone_number: user.phoneNumber\n            });\n\n          database\n            .ref(\"users\")\n            .child(user.uid)\n            .child(\"restaurants\")\n            .child(props.match.params.restaurant)\n            .update({ offers: offersChecked });\n          addUserToDb(user.uid, name);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    }\n  };\n\n  useEffect(() => {\n    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier(\n      \"sign-in-button\",\n      {\n        size: \"invisible\",\n        callback: function(response) {}\n      }\n    );\n  }, []);\n\n  const signInAsGuest = () => {\n    if (anonName != \"\") {\n      firebase\n        .auth()\n        .signInAnonymously()\n        .then(result => {\n          addUserToDb(result.user.uid, anonName);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    } else {\n      window.alert(\"Name is Empty!\");\n    }\n  };\n\n  const addUserToDb = (uid, thisName) => {\n    database\n      .ref(\"users\")\n      .child(uid)\n      .update({ name: thisName, type: \"customer\" });\n\n    database\n      .ref(props.match.params.restaurant)\n      .child(\"tables\")\n      .child(props.match.params.table)\n      .child(\"users\")\n      .child(uid)\n      .update({\n        name: thisName,\n        seat: props.match.params.seat,\n        water_ordered: false\n      });\n  };\n\n  const showGuestSignIn = () => {\n    setGuestSignIn(true);\n  };\n\n  return (\n    <Fragment>\n      <div className=\"d-flex justify-content-center mt-5\">\n        <h2 className=\"text-capitalize\">\n          {\" \"}\n          Welcome to {props.match.params.restaurant}\n        </h2>\n      </div>\n      {props.seatTaken ? (\n        <div className=\"d-flex justify-content-center\">\n          <h2 style={{ color: \"red\" }}> Seat Taken! </h2>{\" \"}\n        </div>\n      ) : null}\n      <div className=\"d-flex justify-content-center mt-5\">\n        <h2> Verify Your Seat </h2>\n      </div>\n      <div className=\"d-flex justify-content-center\">\n        <p> You only have to do this once! </p>\n      </div>\n      {/* <div className=\"d-flex justify-content-center mt-3\">\n        <Form.Group controlId=\"formBasicCheckbox\">\n          <Form.Check\n            checked={offersChecked}\n            onChange={e => setOffersChecked(e.target.checked)}\n            type=\"checkbox\"\n            label=\"Text me Discounts\"\n          />\n        </Form.Group>\n      </div> */}\n      <div className=\"form-group\">\n        <input\n          className=\"form-control mt-5\"\n          type=\"text\"\n          value={phoneNumber}\n          placeholder=\"Phone Number\"\n          onChange={e => setPhoneNumber(e.target.value)}\n        />\n        <div className=\"d-flex justify-content-center mt-3\">\n          <button\n            className=\"btn btn-warning btn-lg btn-block\"\n            onClick={sendVerificationCode}\n          >\n            {\" \"}\n            Send Code{\" \"}\n          </button>\n        </div>\n        <input\n          className=\"form-control mt-5\"\n          type=\"text\"\n          value={authCode}\n          placeholder=\"6-Digit Verification Code\"\n          onChange={e => setAuthCode(e.target.value)}\n          autoComplete=\"one-time-code\"\n        />\n        <input\n          className=\"form-control mt-2\"\n          type=\"text\"\n          value={name}\n          placeholder=\"Enter your Name\"\n          onChange={e => setName(e.target.value)}\n        />\n        <div className=\"d-flex justify-content-center mt-3\">\n          <button\n            className=\"btn btn-dark btn-lg btn-block\"\n            id=\"sign-in-button\"\n            onClick={signInWithPhoneNumber}\n          >\n            {\" \"}\n            Let's Go!{\" \"}\n          </button>\n        </div>\n      </div>\n      {guestSignIn ? (\n        <Fragment>\n          <div className=\"d-flex justify-content-center\">\n            <h4 className=\"text-muted mt-5\"> Sign In As Guest </h4>\n          </div>\n          <div className=\"d-flex justify-content-center\">\n            <p className=\"text-muted\">\n              Not Recommended - Your data will be lost\n            </p>\n          </div>\n          <div className=\"form-group\">\n            <input\n              className=\"form-control\"\n              type=\"text\"\n              value={anonName}\n              placeholder=\"Enter your Name\"\n              onChange={e => setAnonName(e.target.value)}\n            />\n            <div\n              onClick={function() {}}\n              className=\"d-flex justify-content-center mt-2\"\n            >\n              <button\n                className=\"btn btn-outline-secondary btn-sm btn-block\"\n                onClick={signInAsGuest}\n              >\n                Guest Login\n              </button>\n            </div>\n          </div>\n        </Fragment>\n      ) : (\n        <div className=\"d-flex justify-content-center mt-5\">\n          <button onClick={showGuestSignIn} className=\"btn btn-link\">\n            {\" \"}\n            Sign In a Different Way{\" \"}\n          </button>\n        </div>\n      )}\n    </Fragment>\n  );\n};\n\nexport default LoginForm;\n"]},"metadata":{},"sourceType":"module"}